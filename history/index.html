<!doctype html>
<html>
  <head>
    <meta charset=utf-8>
    <title>Future of Coding History</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <!-- this has to be duplicated in history/app.js EXPORT_HTML_PREFIX to make export look the same as this -->
    <style>.alert{border-radius:0}.msg-response{background-color:white!important}</style>
  </head>
  <body class="p-3">

    <div id="app">
      <div class="row">
        <div class="col">
          <input type="date" v-model="fromDate" class="form-control">
        </div>
        <div class="col">
          <input type="date" v-model="toDate" class="form-control">
        </div>
        <div class="col">
          <select v-model="channel" class="custom-select">
            <option value="general">#general</option>
            <option value="feedback">#feedback</option>
            <option value="two-minute-week">#two-minute-week</option>
          </select>
        </div>
      </div>

      <div class="row mt-1">
        <div class="col text-center">
          <button class="btn btn-primary" v-on:click="loadSelected()">Load</button>
        </div>
        <div class="col text-center">
          <button class="btn btn-primary" v-on:click="exportAsMd()">Export as Markdown</button>
        </div>
        <div class="col text-center">
          <button class="btn btn-primary" v-on:click="exportAsHTML()">Export as HTML</button>
        </div>
      </div>

      <div v-if="loadingStatus !== null" class="alert alert-info my-3">
        {{loadingStatus}}
      </div>

      <input type="search" v-model="msgFilter" class="form-control my-3" v-on:keyUp="onFilterChanged" placeholder="Message Filter">

      <div id="msgs-output">
        <div v-for="msg in filteredMsgs" :key="msg.ts" class="alert alert-dark msg-root my-1 p-2 bg-light" :id="msg.$dateStrISO">
          <span class="small text-muted"><a :href="'#' + msg.$dateStrISO">{{msg.$dateStr}}</a></span> <span class="font-weight-bold">{{msg.$userName}}: </span>
          <p v-html="msg.$html"></p>

          <div v-for="resp in msg.responses" :key="resp.ts" class="alert alert-dark msg-response p-2 ml-1 my-1 bg-light" :id="resp.$dateStrISO">
            <span class="small text-muted"><a :href="'#' + resp.$dateStrISO">{{resp.$dateStr}}</a></span> <span class="font-weight-bold">{{resp.$userName}}: </span>
            <p v-html="resp.$html"></p>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="../lib/simple-markdown.js"></script>
    <script type="module" src="app.js"></script>
  </body>
</html>
